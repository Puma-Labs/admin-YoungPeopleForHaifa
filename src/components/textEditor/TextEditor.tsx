import "./styles.sass";

import React, { FC, useState } from "react";
import ReactQuill from "react-quill";
import Quill from "quill";
import "react-quill/dist/quill.snow.css";
import { ReactComponent as ErrorIcon } from "../../assets/icons/error-icon.svg";

interface TextEditorProps {
    value: string;
    onChange: (value: string) => void;
    label?: string;
    placeholder?: string;
    error?: string;
}

const TextEditor: FC<TextEditorProps> = ({ value, onChange, label, placeholder = "", error = "" }) => {
    const [text, setText] = useState(value);

    const handleChange = (value: string) => {
        setText(value);
        onChange(value);
    };

    const formats = ["blockquote", "link", "align", "direction"];

    const icons = Quill.import("ui/icons");

    icons.align = {
        left: '<svg class="custom-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 8.66667C8 8.29848 7.70152 8 7.33333 8H0.666667C0.298477 8 0 8.29848 0 8.66667C0 9.03486 0.298477 9.33333 0.666667 9.33333H7.33333C7.70152 9.33333 8 9.03486 8 8.66667ZM8 3.33333C8 2.96514 7.70152 2.66667 7.33333 2.66667H0.666667C0.298477 2.66667 0 2.96514 0 3.33333C0 3.70152 0.298477 4 0.666667 4H7.33333C7.70152 4 8 3.70152 8 3.33333ZM0 6C0 6.36819 0.298477 6.66667 0.666667 6.66667H11.3333C11.7015 6.66667 12 6.36819 12 6C12 5.63181 11.7015 5.33333 11.3333 5.33333H0.666667C0.298477 5.33333 0 5.63181 0 6ZM0 11.3333C0 11.7015 0.298477 12 0.666667 12H11.3333C11.7015 12 12 11.7015 12 11.3333C12 10.9651 11.7015 10.6667 11.3333 10.6667H0.666667C0.298477 10.6667 0 10.9651 0 11.3333ZM0.666667 0C0.298477 0 0 0.298477 0 0.666667C0 1.03486 0.298477 1.33333 0.666667 1.33333H11.3333C11.7015 1.33333 12 1.03486 12 0.666667C12 0.298477 11.7015 0 11.3333 0H0.666667Z" fill="#383838"/></svg>',
        center: '<svg class="custom-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.33333 8C2.96514 8 2.66667 8.29848 2.66667 8.66667C2.66667 9.03486 2.96514 9.33333 3.33333 9.33333H8.66667C9.03486 9.33333 9.33333 9.03486 9.33333 8.66667C9.33333 8.29848 9.03486 8 8.66667 8H3.33333ZM0 11.3333C0 11.7015 0.298477 12 0.666666 12H11.3333C11.7015 12 12 11.7015 12 11.3333C12 10.9651 11.7015 10.6667 11.3333 10.6667H0.666666C0.298477 10.6667 0 10.9651 0 11.3333ZM0 6C0 6.36819 0.298477 6.66667 0.666667 6.66667H11.3333C11.7015 6.66667 12 6.36819 12 6C12 5.63181 11.7015 5.33333 11.3333 5.33333H0.666667C0.298477 5.33333 0 5.63181 0 6ZM3.33333 2.66667C2.96514 2.66667 2.66667 2.96514 2.66667 3.33333C2.66667 3.70152 2.96514 4 3.33333 4H8.66667C9.03486 4 9.33333 3.70152 9.33333 3.33333C9.33333 2.96514 9.03486 2.66667 8.66667 2.66667H3.33333ZM0.666667 0C0.298477 0 0 0.298477 0 0.666667C0 1.03486 0.298477 1.33333 0.666667 1.33333H11.3333C11.7015 1.33333 12 1.03486 12 0.666667C12 0.298477 11.7015 0 11.3333 0H0.666667Z" fill="#383838"/></svg>',
        right: '<svg class="custom-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 11.3333C0 11.7015 0.298477 12 0.666667 12H11.3333C11.7015 12 12 11.7015 12 11.3333C12 10.9651 11.7015 10.6667 11.3333 10.6667H0.666667C0.298477 10.6667 0 10.9651 0 11.3333ZM4 8.66667C4 9.03486 4.29848 9.33333 4.66667 9.33333H11.3333C11.7015 9.33333 12 9.03486 12 8.66667C12 8.29848 11.7015 8 11.3333 8H4.66667C4.29848 8 4 8.29848 4 8.66667ZM0 6C0 6.36819 0.298477 6.66667 0.666667 6.66667H11.3333C11.7015 6.66667 12 6.36819 12 6C12 5.63181 11.7015 5.33333 11.3333 5.33333H0.666667C0.298477 5.33333 0 5.63181 0 6ZM4 3.33333C4 3.70152 4.29848 4 4.66667 4H11.3333C11.7015 4 12 3.70152 12 3.33333C12 2.96514 11.7015 2.66667 11.3333 2.66667H4.66667C4.29848 2.66667 4 2.96514 4 3.33333ZM0.666667 0C0.298477 0 0 0.298477 0 0.666667C0 1.03486 0.298477 1.33333 0.666667 1.33333H11.3333C11.7015 1.33333 12 1.03486 12 0.666667C12 0.298477 11.7015 0 11.3333 0H0.666667Z" fill="#383838"/></svg>',
    };
    icons.direction = {
        "": '<svg class="custom-icon" width="11" height="12" viewBox="0 0 11 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.60495 7.46441V4.97628C1.86973 4.9765 1.16867 4.67991 0.674852 4.15974C0.181032 3.63957 -0.059529 2.94428 0.0125584 2.24554C0.142829 0.951713 1.35435 0 2.71568 0H7.16443C7.52267 0 7.81578 0.279916 7.81578 0.622035C7.81578 0.964154 7.52267 1.24407 7.16443 1.24407H6.51307V7.46441C6.51307 7.80653 6.21996 8.08645 5.86172 8.08645C5.50348 8.08645 5.21037 7.80653 5.21037 7.46441V1.24407H3.90766V7.46441C3.90766 7.80653 3.61455 8.08645 3.2563 8.08645C2.89806 8.08645 2.60495 7.80653 2.60495 7.46441ZM8.37642 7.99941L10.1937 9.73489C10.3175 9.85307 10.3175 10.0521 10.1872 10.1703L8.3699 11.9058C8.16798 12.1048 7.81625 11.968 7.81625 11.6881V10.5746H0.651354C0.293109 10.5746 1.18747e-09 10.2947 1.18747e-09 9.9526C1.18747e-09 9.61048 0.293109 9.33056 0.651354 9.33056H7.81625V8.21712C7.81611 8.09025 7.89652 7.97596 8.01957 7.92813C8.14262 7.88031 8.28375 7.9085 8.37642 7.99941Z" fill="#383838"/></svg>',
        rtl: '<svg class="custom-icon" width="11" height="12" viewBox="0 0 11 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.21202 7.46441V4.97628C7.94723 4.9765 8.64829 4.67991 9.14211 4.15974C9.63593 3.63957 9.87649 2.94428 9.80441 2.24554C9.67414 0.951713 8.46262 0 7.10129 0H2.65254C2.29429 0 2.00118 0.279916 2.00118 0.622035C2.00118 0.964154 2.29429 1.24407 2.65254 1.24407H3.30389V7.46441C3.30389 7.80653 3.597 8.08645 3.95524 8.08645C4.31349 8.08645 4.6066 7.80653 4.6066 7.46441V1.24407H5.90931V7.46441C5.90931 7.80653 6.20242 8.08645 6.56066 8.08645C6.91891 8.08645 7.21202 7.80653 7.21202 7.46441ZM1.9093 7.99943L0.0920196 9.7349C-0.0317378 9.85309 -0.031738 10.0521 0.0985329 10.1703L1.91581 11.9058C2.11773 12.1049 2.46946 11.968 2.46946 11.6881V10.5746H9.63436C9.99261 10.5746 10.2857 10.2947 10.2857 9.95261C10.2857 9.6105 9.99261 9.33058 9.63436 9.33058H2.46946V8.21714C2.46961 8.09027 2.3892 7.97598 2.26615 7.92815C2.14309 7.88033 2.00197 7.90851 1.9093 7.99943Z" fill="#383838"/></svg>',
    };
    icons.blockquote =
        '<svg title="gggggg" class="custom-icon" width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.2775 7.408C3.1125 7.768 2.76 8 2.3775 8C1.6275 8 1.14 7.16 1.4775 6.448L2.25 4.8H0.75C0.3375 4.8 0 4.44 0 4V0.8C0 0.36 0.3375 0 0.75 0H3.75C4.1625 0 4.5 0.36 4.5 0.8V4.424C4.5 4.672 4.4475 4.912 4.3425 5.136L3.2775 7.408ZM10.7775 7.408C10.6125 7.768 10.26 8 9.8775 8C9.1275 8 8.64 7.16 8.9775 6.448L9.75 4.8H8.25C7.8375 4.8 7.5 4.44 7.5 4V0.8C7.5 0.36 7.8375 0 8.25 0H11.25C11.6625 0 12 0.36 12 0.8V4.424C12 4.672 11.9475 4.912 11.8425 5.136L10.7775 7.408Z" fill="#383838"/></svg>';
    icons.link =
        '<svg class="custom-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85915 4.19574L4.19687 6.85802C4.07087 6.98299 4 7.15311 4 7.33057C4 7.50804 4.07087 7.67815 4.19687 7.80313C4.32185 7.92913 4.49196 8 4.66943 8C4.84689 8 5.01701 7.92913 5.14198 7.80313L7.80426 5.14085C8.06525 4.87986 8.06525 4.45672 7.80426 4.19574C7.54328 3.93475 7.12014 3.93475 6.85915 4.19574Z" fill="#383838"/><path d="M6.16107 9.23902L5.39332 10.0012C4.50103 10.9213 3.06074 11.0246 2.04642 10.2413C1.52275 9.80953 1.2063 9.17606 1.17543 8.49779C1.14457 7.81952 1.40218 7.15989 1.88447 6.68227L2.73619 5.82402C2.84974 5.71133 2.91361 5.55792 2.91361 5.39789C2.91361 5.23786 2.84974 5.08446 2.73619 4.97177C2.62357 4.85815 2.47026 4.79424 2.31033 4.79424C2.1504 4.79424 1.99709 4.85815 1.88447 4.97177L1.12272 5.74C-0.204448 7.02598 -0.376204 9.09604 0.72085 10.5834C1.35771 11.4101 2.31884 11.9232 3.35974 11.9921C4.40063 12.061 5.42093 11.6791 6.16107 10.9435L7.01279 10.0913C7.24799 9.85593 7.24799 9.47437 7.01279 9.23902C6.7776 9.00368 6.39627 9.00368 6.16107 9.23902Z" fill="#383838"/><path d="M10.5865 0.728477C9.08949 -0.38091 7.00217 -0.206216 5.71011 1.1366L5.06233 1.79679C4.91259 1.90571 4.81602 2.07304 4.79659 2.25724C4.77715 2.44145 4.83666 2.62527 4.96036 2.76308C5.07298 2.8767 5.22629 2.94061 5.38622 2.94061C5.54615 2.94061 5.69946 2.8767 5.81208 2.76308L6.59183 1.97684C7.47961 1.05235 8.92204 0.9487 9.93273 1.73677C10.4604 2.16866 10.7795 2.80473 10.8104 3.48613C10.8413 4.16752 10.581 4.8299 10.0947 5.30782L9.24296 6.16608C9.12941 6.27877 9.06554 6.43217 9.06554 6.5922C9.06554 6.75223 9.12941 6.90563 9.24296 7.01833C9.35558 7.13195 9.50889 7.19586 9.66882 7.19586C9.82875 7.19586 9.98206 7.13195 10.0947 7.01833L10.9464 6.16608C11.6794 5.42563 12.0598 4.40609 11.9909 3.36614C11.9221 2.32618 11.4107 1.36574 10.5865 0.728477Z" fill="#383838"/></svg>';

    const modules = {
        toolbar: {
            container: [
                [
                    { align: ["left", "center", "right"], title: "Alignment of text" },
                    { direction: "rtl" },
                    "blockquote",
                    "link",
                ],
            ],
        },
    };

    return (
        <>
            {label && <div className="quill-label">{label}</div>}
            <div className={`quill-container ${error ? "error" : ""}`}>
                <ReactQuill
                    value={text}
                    onChange={handleChange}
                    modules={modules}
                    formats={formats}
                    placeholder={placeholder}
                />
                {error && (
                    <span className="errorComponent">
                        <span className="errorIcon">
                            <ErrorIcon />
                        </span>
                        <span className="errorText">{error}</span>
                    </span>
                )}
            </div>
        </>
    );
};

export default TextEditor;

